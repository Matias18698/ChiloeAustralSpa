import{C as j,r as x,k,x as C,c as o,b as l,d as g,u as r,m as A,w as L,e as a,f as b,n as T,t as n,i as D,g as c,j as y,F as m,h as w,v as S}from"./app-Kob4L842.js";import{A as V}from"./AppMain-BFqa2tYw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const $={class:"min-h-screen bg-gradient-to-br from-blue-50 to-white py-10 px-4 sm:px-6 lg:px-8"},F={class:"max-w-2xl mx-auto bg-white p-8 rounded-2xl shadow-xl space-y-8 border border-gray-200"},M={class:"relative"},B={key:0,class:"absolute z-10 w-full bg-white border mt-1 rounded shadow max-h-48 overflow-auto"},R=["onClick"],U={key:1,class:"text-red-500 text-sm mt-1"},N={key:0,class:"text-red-500 text-sm mt-1"},z=["value"],E={key:0,class:"text-red-500 text-sm mt-1"},q=["disabled"],K={__name:"Manual",props:{trabajadores:Array,embarcaciones:Array},setup(_){const p=_,s=j({trabajador_id:"",embarcacion_id:"",fecha:new Date().toLocaleDateString("en-CA"),tipo_asistencia:""}),h=[{value:"D",label:"Descanso"},{value:"TR",label:"Trabajo"},{value:"L",label:"Licencia"},{value:"F",label:"Falta"}],u=x({tipo:"",mensaje:"",visible:!1}),v=(i,e="success",t=3e3)=>{u.value={mensaje:i,tipo:e,visible:!0},setTimeout(()=>{u.value.visible=!1},t)},d=x(""),f=k(()=>{const i=d.value.toLowerCase();return p.trabajadores.filter(e=>e.nombre.toLowerCase().includes(i)||e.rut.toLowerCase().includes(i))});return C(d,i=>{const e=p.trabajadores.find(t=>`${t.nombre} - ${t.rut}`.toLowerCase()===i.toLowerCase());s.trabajador_id=e?e.id:""}),(i,e)=>(l(),o(m,null,[g(r(A),{title:"Registrar Asistencia"}),g(V,null,{default:L(()=>[a("div",$,[a("div",F,[e[8]||(e[8]=a("h2",{class:"text-3xl font-bold text-blue-800 border-b pb-4"},"Registrar Asistencia",-1)),u.value.visible?(l(),o("div",{key:0,class:T(["p-3 rounded-md text-sm font-medium text-center",u.value.tipo==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},n(u.value.mensaje),3)):b("",!0),a("form",{onSubmit:e[3]||(e[3]=D(t=>r(s).post(i.route("asistencia.store"),{onSuccess:()=>v("Asistencia registrada correctamente."),onError:()=>v("Hubo un error al registrar la asistencia.","error")}),["prevent"])),class:"space-y-6"},[a("div",M,[e[4]||(e[4]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Trabajador",-1)),c(a("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),placeholder:"Buscar por nombre o RUT",class:"form-input w-full rounded border-gray-300",autocomplete:"off"},null,512),[[y,d.value]]),d.value&&f.value.length?(l(),o("ul",B,[(l(!0),o(m,null,w(f.value,t=>(l(),o("li",{key:t.id,class:"px-3 py-2 hover:bg-blue-100 cursor-pointer",onClick:G=>d.value=`${t.nombre} - ${t.rut}`},n(t.nombre)+" - "+n(t.rut),9,R))),128))])):b("",!0),r(s).errors.trabajador_id?(l(),o("p",U,n(r(s).errors.trabajador_id),1)):b("",!0)]),a("div",null,[e[5]||(e[5]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha",-1)),c(a("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=t=>r(s).fecha=t),class:"form-input w-full rounded border-gray-300"},null,512),[[y,r(s).fecha]]),r(s).errors.fecha?(l(),o("p",N,n(r(s).errors.fecha),1)):b("",!0)]),a("div",null,[e[7]||(e[7]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de asistencia",-1)),c(a("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>r(s).tipo_asistencia=t),class:"form-select w-full rounded border-gray-300"},[e[6]||(e[6]=a("option",{disabled:"",value:""},"Selecciona un tipo",-1)),(l(),o(m,null,w(h,t=>a("option",{key:t.value,value:t.value},n(t.label),9,z)),64))],512),[[S,r(s).tipo_asistencia]]),r(s).errors.tipo_asistencia?(l(),o("p",E,n(r(s).errors.tipo_asistencia),1)):b("",!0)]),a("div",null,[a("button",{type:"submit",class:"w-full py-3 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition font-semibold",disabled:r(s).processing||!r(s).trabajador_id}," Guardar asistencia ",8,q)])],32)])])]),_:1})],64))}};export{K as default};
